# FoodSave - æ™ºèƒ½é£Ÿæç®¡ç†ç³»ç»Ÿ

## é¡¹ç›®ç®€ä»‹

FoodSaveæ˜¯ä¸€ä¸ªåŸºäºVue 3çš„æ™ºèƒ½é£Ÿæç®¡ç†ç³»ç»Ÿï¼Œå¸®åŠ©ç”¨æˆ·ç®¡ç†å®¶åº­é£Ÿæï¼Œæä¾›è¿‡æœŸæé†’ã€æ™ºèƒ½æ¨èèœè°±ç­‰åŠŸèƒ½ã€‚

## æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Vue 3 + Composition API
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±ç®¡ç†**: Vue Router 4
- **UIç»„ä»¶åº“**: Vant 4
- **æ ·å¼é¢„å¤„ç†**: SCSS
- **æ„å»ºå·¥å…·**: Vite
- **æ•°æ®åº“**: MongoDB
- **åç«¯**: Node.js + Express

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ views/                  # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Index.vue          # é¦–é¡µ
â”‚   â”œâ”€â”€ Addfoot.vue        # æ·»åŠ é£Ÿæé¡µ
â”‚   â”œâ”€â”€ Computed.vue       # ç»Ÿè®¡é¡µé¢
â”‚   â”œâ”€â”€ FoodMap.vue        # é£Ÿæåœ°å›¾
â”‚   â”œâ”€â”€ Mine.vue           # ä¸ªäººä¸­å¿ƒ
â”‚   â”œâ”€â”€ RecipeDetail.vue   # èœè°±è¯¦æƒ…
â”‚   â””â”€â”€ IngredientRecipes.vue # é£Ÿæèœè°±åˆ—è¡¨
â”œâ”€â”€ components/             # ç»„ä»¶
â”‚   â”œâ”€â”€ common/            # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Head.vue       # å¤´éƒ¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ TabBar.vue     # åº•éƒ¨å¯¼èˆª
â”‚   â””â”€â”€ business/          # ä¸šåŠ¡ç»„ä»¶
â”‚       â”œâ”€â”€ SmartRecommendation.vue # æ™ºèƒ½æ¨è
â”‚       â””â”€â”€ FoodCardDetail.vue      # é£Ÿæè¯¦æƒ…å¡ç‰‡
â”œâ”€â”€ services/              # æœåŠ¡å±‚
â”‚   â””â”€â”€ api.js            # APIæœåŠ¡
â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ index.js          # é€šç”¨å·¥å…·
â”œâ”€â”€ hooks/                 # ç»„åˆå¼API
â”‚   â”œâ”€â”€ useFood.js        # é£Ÿæç®¡ç†Hook
â”‚   â””â”€â”€ useRecipe.js      # èœè°±ç®¡ç†Hook
â”œâ”€â”€ constants/             # å¸¸é‡é…ç½®
â”‚   â””â”€â”€ index.js          # é¡¹ç›®å¸¸é‡
â”œâ”€â”€ types/                 # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.js          # æ•°æ®ç±»å‹
â”œâ”€â”€ store/                 # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ index.js          # ä¸»store
â”‚   â”œâ”€â”€ addfoot.js        # æ·»åŠ é£Ÿæstore
â”‚   â””â”€â”€ computed.js       # ç»Ÿè®¡store
â”œâ”€â”€ router/                # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ index.js          # è·¯ç”±å®šä¹‰
â””â”€â”€ assets/                # é™æ€èµ„æº
    â”œâ”€â”€ images/           # å›¾ç‰‡èµ„æº
    â””â”€â”€ style/            # æ ·å¼æ–‡ä»¶
```

## æ•°æ®åº“ä¸æ•°æ®è¡¨

- æ•°æ®åº“: MongoDBï¼Œåº“å `food_management`
- è¿æ¥: é»˜è®¤ `mongodb://localhost:27017/food_management`ï¼›æ”¯æŒç¯å¢ƒå˜é‡ï¼š
  - `MONGO_URI`ã€`MONGO_DB`ã€`MONGO_USER`ã€`MONGO_PASS`ã€`MONGO_AUTH_SOURCE`
  - `MONGO_SERVER_SELECTION_TIMEOUT_MS`ã€`MONGO_SOCKET_TIMEOUT_MS`ã€`MONGO_MAX_RETRIES`
  - `JWT_SECRET`ï¼ˆè®¤è¯ï¼‰
- é›†åˆä¸å­—æ®µï¼š
  - `users`: `username`ã€`email`ã€`phone`ã€`password`ã€`nickname`ã€`avatar`ã€`bio`ã€`createdAt`ã€`updatedAt`
  - `foods`: `name`ã€`category`ã€`storageLocation`ã€`purchaseDate`ã€`shelfLife`ã€`expireDate`ã€`quantity`ã€`unit`ã€`synonyms[]`ã€`description`ã€`nutritionInfo{calories,protein,carbs,fat}`ã€`createdAt`ã€`updatedAt`
- ç´¢å¼•:
  - `foods` æ–‡æœ¬ç´¢å¼•ï¼š`name`ã€`category`ã€`storageLocation`ã€`synonyms`
  - æ™®é€šç´¢å¼•ï¼š`name`ã€`category`
- å¥åº·æ£€æŸ¥:
  - `GET /api/health/db` è¿”å›è¿æ¥çŠ¶æ€ä¸æ–‡æ¡£è®¡æ•°
- è¿æ¥æµ‹è¯•ï¼ˆWindowsï¼‰:
  - åç«¯: åŒå‡» `start-server.bat` æˆ–æ‰§è¡Œ `node server/app.js`
  - éªŒè¯: è®¿é—® `http://localhost:3001/api/health/db`
  - Mongosh: `mongosh "mongodb://localhost:27017/food_management" --eval "db.users.countDocuments(); db.foods.countDocuments();"`

- å¸¸ç”¨APIï¼ˆåç«¯ï¼‰ï¼š
  - é£Ÿæï¼š`GET /api/food`ã€`GET /api/food/search?q=...`ã€`GET /api/food/suggestions?q=...`ã€`POST /api/food`ã€`PUT /api/food/:id`ã€`DELETE /api/food/:id`
  - ç”¨æˆ·ï¼š`POST /api/auth/login`ã€`POST /api/register`ã€`GET /api/users/:userId`ã€`PUT /api/users/:userId`

## AI æ™ºèƒ½åŠ©æ‰‹ï¼ˆDeepSeekï¼‰

- å…¥å£ä¸äº¤äº’ï¼š
  - é¡µé¢å³ä¸‹è§’å¯æ‹–åŠ¨å›¾æ ‡ï¼Œç‚¹å‡»å¼¹å‡ºèŠå¤©æ¡†ï¼ˆ`src/App.vue:155`ï¼‰
  - æ”¯æŒåŸºäºå½“å‰é£Ÿæåº“çš„æ™ºèƒ½é—®ç­”ä¸èœè°±ç”Ÿæˆï¼ŒæŒ‰å¡ç‰‡ç»“æ„å±•ç¤ºï¼ˆ`src/App.vue:165`ï¼‰
- æœåŠ¡ç«¯æ¥å£ï¼š
  - `POST /api/ai/chat`
  - è¯·æ±‚ä½“ï¼š
    ```json
    {
      "question": "å¸®æˆ‘ç”¨é’æ¤’åšä¸€é“èœ",
      "context": {
        "foods": [ { "name": "é’æ¤’", "category": "è”¬èœç±»", "expireDate": "2025-11-18" } ],
        "history": [ { "role": "user", "content": "å£å‘³æ¸…æ·¡" } ]
      }
    }
    ```
  - è¿”å›ä½“ï¼ˆä¼˜å…ˆä¸¥æ ¼ JSONï¼‰ï¼š
    ```json
    {
      "success": true,
      "reply": {
        "recipes": [
          {
            "name": "æ¸…ç‚’é’æ¤’åœŸè±†ç‰‡",
            "ingredients": [ { "name": "é’æ¤’", "amount": 2, "unit": "ä¸ª" }, { "name": "åœŸè±†", "amount": 1, "unit": "ä¸ª" } ],
            "steps": [ "åˆ‡ç‰‡", "çƒ­é”…å°‘æ²¹å¿«ç‚’", "åŠ ç›å‡ºé”…" ],
            "timeMinutes": 15,
            "storageAdvice": "ç°åšç°åƒï¼Œå‰©èœå†·è—ä¸è¶…è¿‡24å°æ—¶"
          }
        ],
        "usedFoods": ["é’æ¤’", "åœŸè±†"],
        "notes": "ä¼˜å…ˆä½¿ç”¨å³å°†è¿‡æœŸé£Ÿæ"
      }
    }
    ```
- ç¯å¢ƒå˜é‡ï¼ˆWindowsï¼‰ï¼š
  - æ°¸ä¹…ï¼š
    - `setx DEEPSEEK_API_KEY "<ä½ çš„å¯†é’¥>"`
    - `setx DEEPSEEK_MODEL "deepseek-chat"`
    - `setx AI_TIMEOUT_MS 15000`
  - ä¸´æ—¶ï¼ˆå½“å‰ç»ˆç«¯ï¼‰ï¼š
    - PowerShellï¼š`$env:DEEPSEEK_API_KEY = "<ä½ çš„å¯†é’¥>"`
- å®‰å…¨è¯´æ˜ï¼šå¯†é’¥ä»…é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œåç«¯ä»£ç†è°ƒç”¨ï¼Œä¸åœ¨å‰ç«¯æš´éœ²ï¼ˆ`server/services/aiClient.js:8`ï¼‰ã€‚
- ç›¸å…³ä»£ç ï¼š
  - å®¢æˆ·ç«¯è°ƒç”¨ï¼š`src/services/api.js:210`
  - å‰ç«¯æ¸²æŸ“ï¼š`src/App.vue:165`
  - è·¯ç”±å¤„ç†ï¼š`server/routes/ai.js:10`
  - DeepSeek æ¥å…¥ï¼š`server/services/aiClient.js:8`

## ä½¿ç”¨æŒ‡å¼•ä¸æç¤º

- æ“ä½œæŒ‡å¼•é®ç½©ï¼šè¿›å…¥åˆ†ç±»è¯¦æƒ…åä¸€æ¬¡æ€§æ˜¾ç¤ºâ€œå‘å·¦æ»‘åŠ¨æ¡ç›®å¯å–å‡ºâ€ï¼ˆç‚¹å‡»é®ç½©å…³é—­ï¼Œæ•°ç§’åè‡ªåŠ¨éšè—ï¼‰ï¼Œè§ `src/components/business/FoodCardDetail.vue:54`ã€‚
- å¥åº·æ£€æŸ¥ï¼šè®¿é—® `GET /api/health/db` æŸ¥çœ‹æ•°æ®åº“è¿æ¥ä¸æ–‡æ¡£è®¡æ•°ï¼ˆ`server/app.js:28`ï¼‰ã€‚
- ä¾èµ–æ£€æŸ¥ï¼šè‹¥åç«¯æç¤ºç¼ºå°‘ `axios`ï¼Œåœ¨é¡¹ç›®æ ¹æ‰§è¡Œ `pnpm add axios`ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### 1. é£Ÿæç®¡ç†
- æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤é£Ÿæ
- é£Ÿæåˆ†ç±»ç®¡ç†
- å­˜å‚¨ä½ç½®ç®¡ç†
- è¿‡æœŸæ—¶é—´è¿½è¸ª

### 2. æ™ºèƒ½æ¨è
- åŸºäºå³å°†è¿‡æœŸé£Ÿæçš„èœè°±æ¨è
- å¤šé£Ÿæå¤šèœè°±å±•ç¤º
- éšæœºåˆ·æ–°æ¨èå†…å®¹
- ä¸€é”®è·³è½¬åˆ¶ä½œæ­¥éª¤

### 3. è¿‡æœŸæé†’
- å®æ—¶è®¡ç®—è¿‡æœŸå¤©æ•°
- è¿‡æœŸçŠ¶æ€åˆ†ç±»æ˜¾ç¤º
- æ™ºèƒ½é¢œè‰²æ ‡è¯†
- æ‰¹é‡æ“ä½œæ”¯æŒ

### 4. ç»Ÿè®¡åˆ†æ
- é£Ÿæä½¿ç”¨ç»Ÿè®¡
- è¿‡æœŸç‡åˆ†æ
- åˆ†ç±»å æ¯”å±•ç¤º
- è¶‹åŠ¿å›¾è¡¨æ˜¾ç¤º

## ä¼ä¸šçº§ç‰¹æ€§

### 1. æ¶æ„è®¾è®¡
- **åˆ†å±‚æ¶æ„**: è¡¨ç°å±‚ã€ä¸šåŠ¡å±‚ã€æœåŠ¡å±‚ã€å·¥å…·å±‚
- **æ¨¡å—åŒ–**: æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼ŒèŒè´£æ¸…æ™°
- **ç»„åˆå¼API**: ä½¿ç”¨Vue 3 Composition APIæé«˜ä»£ç å¤ç”¨æ€§
- **ç±»å‹å®‰å…¨**: JSDocç±»å‹æ³¨é‡Šï¼Œæé«˜ä»£ç å¯ç»´æŠ¤æ€§

### 2. ä»£ç è§„èŒƒ
- **ç»Ÿä¸€å‘½å**: éµå¾ªVueå®˜æ–¹å‘½åè§„èŒƒ
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **ä»£ç æ³¨é‡Š**: è¯¦ç»†çš„å‡½æ•°å’Œæ¨¡å—æ³¨é‡Š
- **æ–‡ä»¶ç»„ç»‡**: æ¸…æ™°çš„ç›®å½•ç»“æ„å’Œæ–‡ä»¶å‘½å

### 3. æ€§èƒ½ä¼˜åŒ–
- **æ‡’åŠ è½½**: è·¯ç”±å’Œç»„ä»¶æ‡’åŠ è½½
- **ç¼“å­˜æœºåˆ¶**: æ•°æ®ç¼“å­˜å’Œæœ¬åœ°å­˜å‚¨
- **é˜²æŠ–èŠ‚æµ**: ç”¨æˆ·äº¤äº’ä¼˜åŒ–
- **å†…å­˜ç®¡ç†**: åŠæ—¶æ¸…ç†äº‹ä»¶ç›‘å¬å™¨

### 4. å¯ç»´æŠ¤æ€§
- **å¸¸é‡ç®¡ç†**: ç»Ÿä¸€çš„å¸¸é‡é…ç½®
- **å·¥å…·å‡½æ•°**: é€šç”¨åŠŸèƒ½æŠ½å–
- **Hookå¤ç”¨**: ä¸šåŠ¡é€»è¾‘ç»„åˆå¼å¤ç”¨
- **æœåŠ¡å°è£…**: APIè°ƒç”¨ç»Ÿä¸€å°è£…

## å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- npm >= 8.0.0 æˆ– yarn >= 1.22.0

### å®‰è£…ä¾èµ–
```bash
npm install
# æˆ–
yarn install
```

### å¼€å‘è¿è¡Œ
```bash
# å‰ç«¯
npm run dev
# æˆ–
pnpm run dev
```

```bash
# åç«¯ï¼ˆWindowsï¼‰
# æ¨èï¼šåŒå‡» start-server.bat
start-server.bat

# æˆ–å‘½ä»¤è¡Œå¯åŠ¨
pnpm run server
# æˆ–
node server/app.js

# é…ç½® DeepSeekï¼ˆWindowsï¼‰
# è®¾ç½®å¯†é’¥åé‡å¯ç»ˆç«¯ï¼Œå†å¯åŠ¨åç«¯
setx DEEPSEEK_API_KEY "<ä½ çš„å¯†é’¥>"
setx DEEPSEEK_MODEL "deepseek-chat"
```

```bash
# å®Œæ•´å¯åŠ¨ï¼ˆåç«¯ + å‰ç«¯ï¼‰
# å…ˆå¯åŠ¨åç«¯ï¼Œå†è¿è¡Œå‰ç«¯
start-server.bat
pnpm run dev

# æˆ–ä½¿ç”¨é¡¹ç›®è„šæœ¬
pnpm run dev:full
```

### æ„å»ºéƒ¨ç½²
```bash
npm run build
# æˆ–
yarn build
```

## ä»£ç è§„èŒƒ

### 1. ç»„ä»¶å‘½å
- é¡µé¢ç»„ä»¶ï¼šPascalCase (å¦‚: `Index.vue`)
- ä¸šåŠ¡ç»„ä»¶ï¼šPascalCase (å¦‚: `SmartRecommendation.vue`)
- é€šç”¨ç»„ä»¶ï¼šPascalCase (å¦‚: `Head.vue`)

### 2. å‡½æ•°å‘½å
- äº‹ä»¶å¤„ç†ï¼š`handle` + åŠ¨ä½œ (å¦‚: `handleClick`)
- å·¥å…·å‡½æ•°ï¼šåŠ¨è¯å¼€å¤´ (å¦‚: `calculateExpiryDays`)
- Hookå‡½æ•°ï¼š`use` + åŠŸèƒ½ (å¦‚: `useFood`)

### 3. å¸¸é‡å‘½å
- å…¨å¤§å†™ä¸‹åˆ’çº¿åˆ†éš” (å¦‚: `API_ENDPOINTS`)
- æŒ‰åŠŸèƒ½åˆ†ç»„ç®¡ç†

### 4. æ–‡ä»¶ç»„ç»‡
- æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†ç›®å½•
- ç›¸å…³æ–‡ä»¶å°±è¿‘æ”¾ç½®
- é¿å…æ·±å±‚åµŒå¥—

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## æ›´æ–°æ—¥å¿—

### v2.0.0 (2025-01-12)
- ğŸ‰ é‡æ„é¡¹ç›®æ¶æ„ï¼Œé‡‡ç”¨ä¼ä¸šçº§æ ‡å‡†
- âœ¨ ä¼˜åŒ–æ™ºèƒ½æ¨èåŠŸèƒ½ï¼Œæ”¯æŒå¤šé£Ÿæå¤šèœè°±
- ğŸ”§ å¼•å…¥ç»„åˆå¼APIï¼Œæé«˜ä»£ç å¤ç”¨æ€§
- ğŸ“¦ é‡æ–°ç»„ç»‡é¡¹ç›®ç»“æ„ï¼Œæé«˜å¯ç»´æŠ¤æ€§
- ğŸ› ä¿®å¤å·²çŸ¥é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

### v1.0.0 (2024-12-01)
- ğŸ‰ é¡¹ç›®åˆå§‹ç‰ˆæœ¬
- âœ¨ åŸºç¡€é£Ÿæç®¡ç†åŠŸèƒ½
- âœ¨ è¿‡æœŸæé†’åŠŸèƒ½
- âœ¨ ç®€å•èœè°±æ¨è